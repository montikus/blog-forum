<!doctype html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org"
	  th:replace="~{fragments/layout :: uklad(~{::title}, ~{::section})}">
<head>
	<title>Dashboard</title>
</head>
<section>
	<div class="d-flex justify-content-between align-items-center mb-4 page-header">
		<h1 class="mb-0">Moje posty</h1>
		<a class="btn btn-primary" th:href="@{/posts/new}">Nowy post</a>
	</div>
	<table class="table table-striped bg-white shadow-sm">
		<thead>
		<tr>
			<th>Tytul</th>
			<th>Ocena</th>
			<th>Komentarze</th>
			<th></th>
		</tr>
		</thead>
		<tbody>
		<tr th:each="post : ${stronaPostow.content}">
			<td>
				<a th:href="@{/posts/{idPosta}(idPosta=${post.id})}" th:text="${post.tytul}">Tytul</a>
			</td>
			<td th:text="${#numbers.formatDecimal(post.sredniaOcena, 1, 2)}">0</td>
			<td th:text="${post.liczbaKomentarzy}">0</td>
			<td class="text-end">
				<a class="btn btn-sm btn-outline-secondary" th:href="@{/posts/{idPosta}/edit(idPosta=${post.id})}">Edytuj</a>
				<form class="d-inline" th:action="@{/posts/{idPosta}/delete(idPosta=${post.id})}" method="post">
					<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
					<button class="btn btn-sm btn-outline-danger" type="submit">Usun</button>
				</form>
			</td>
		</tr>
		<tr th:if="${#lists.isEmpty(stronaPostow.content)}">
			<td colspan="4" class="text-muted">Brak postow.</td>
		</tr>
		</tbody>
	</table>

	<nav class="mt-4" th:if="${stronaPostow.totalPages > 1}">
		<ul class="pagination">
			<li class="page-item" th:classappend="${stronaPostow.first} ? 'disabled'">
				<a class="page-link" th:href="@{/dashboard(page=${stronaPostow.number - 1})}">Poprzednia</a>
			</li>
			<li class="page-item"
				th:each="nr : ${#numbers.sequence(0, stronaPostow.totalPages - 1)}"
				th:classappend="${nr == stronaPostow.number} ? 'active'">
				<a class="page-link" th:href="@{/dashboard(page=${nr})}" th:text="${nr + 1}">1</a>
			</li>
			<li class="page-item" th:classappend="${stronaPostow.last} ? 'disabled'">
				<a class="page-link" th:href="@{/dashboard(page=${stronaPostow.number + 1})}">Nastepna</a>
			</li>
		</ul>
	</nav>
</section>
</html>
