<!doctype html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org"
	  th:replace="~{fragments/layout :: uklad(~{::title}, ~{::section})}">
<head>
	<title>Wyszukiwanie</title>
</head>
<section>
	<div class="page-header mb-4">
		<h1 class="mb-0">Wyszukiwanie postow</h1>
	</div>
	<form class="row g-2 align-items-end mb-4" th:action="@{/search}" method="get">
		<div class="col-md-5">
			<label class="form-label" for="query">Fraza</label>
			<input id="query" name="query" class="form-control" type="text" th:value="${query}">
		</div>
		<div class="col-md-5">
			<label class="form-label" for="author">Autor</label>
			<input id="author" name="author" class="form-control" type="text" th:value="${author}">
		</div>
		<div class="col-md-2 d-grid">
			<button class="btn btn-primary" type="submit">Szukaj</button>
		</div>
	</form>

	<div class="row g-3">
		<div class="col-md-6" th:each="post : ${stronaPostow.content}">
			<div class="card h-100 shadow-sm">
				<div class="card-body">
					<h5 class="card-title" th:text="${post.tytul}">Tytul</h5>
					<p class="card-text text-muted small">
						<span th:text="'Srednia: ' + ${#numbers.formatDecimal(post.sredniaOcena, 1, 2)}"></span>
						<span class="mx-2">â€¢</span>
						<span th:text="'Komentarze: ' + ${post.liczbaKomentarzy}"></span>
					</p>
					<p class="card-text" th:text="${#strings.abbreviate(post.tresc, 200)}"></p>
					<a class="btn btn-outline-primary btn-sm" th:href="@{/posts/{idPosta}(idPosta=${post.id})}">
						Czytaj dalej
					</a>
				</div>
			</div>
		</div>
	</div>

	<nav class="mt-4" th:if="${stronaPostow.totalPages > 1}">
		<ul class="pagination">
			<li class="page-item" th:classappend="${stronaPostow.first} ? 'disabled'">
				<a class="page-link"
				   th:href="@{/search(page=${stronaPostow.number - 1}, query=${query}, author=${author})}">
					Poprzednia
				</a>
			</li>
			<li class="page-item"
				th:each="nr : ${#numbers.sequence(0, stronaPostow.totalPages - 1)}"
				th:classappend="${nr == stronaPostow.number} ? 'active'">
				<a class="page-link"
				   th:href="@{/search(page=${nr}, query=${query}, author=${author})}"
				   th:text="${nr + 1}">1</a>
			</li>
			<li class="page-item" th:classappend="${stronaPostow.last} ? 'disabled'">
				<a class="page-link"
				   th:href="@{/search(page=${stronaPostow.number + 1}, query=${query}, author=${author})}">
					Nastepna
				</a>
			</li>
		</ul>
	</nav>
</section>
</html>
